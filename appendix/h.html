
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Appendix H: Encryption Example Â· Kubernetes Hardening Guide (Produced by the National Security Agency)</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-image-captions/image-captions.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism-ghcolors.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-lightbox/css/lightbox.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-insert-logo/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="i.html" />
    
    
    <link rel="prev" href="g.html" />
    

    
        <link rel="shortcut icon" href='../favicon.ico' type="image/x-icon">
    
    
        <link rel="bookmark" href='../favicon.ico' type="image/x-icon">
    
    
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"repo":"seifrajhi/kubernetes-hardening-checklist-guidance","types":["star"],"size":"small"};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://seifrajhi.github.io/kubernetes-hardening-checklist-guidance" target="_blank" class="custom-link">Return to home page</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        <li class="header">start</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.1.</b>
                    
                    Description
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../notices-and-hitory.html">
            
                <a href="../notices-and-hitory.html">
            
                    
                        <b>1.2.</b>
                    
                    Notices and History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../publication-information.html">
            
                <a href="../publication-information.html">
            
                    
                        <b>1.3.</b>
                    
                    publication information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../executive-summary.html">
            
                <a href="../executive-summary.html">
            
                    
                        <b>1.4.</b>
                    
                    executive summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../corrigendum.html">
            
                <a href="../corrigendum.html">
            
                    
                        <b>1.5.</b>
                    
                    Corrigendum
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Text</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../introduction.html">
            
                <a href="../introduction.html">
            
                    
                        <b>2.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../threat-model.html">
            
                <a href="../threat-model.html">
            
                    
                        <b>2.2.</b>
                    
                    Threat Modeling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../kubernetes-pod-security.html">
            
                <a href="../kubernetes-pod-security.html">
            
                    
                        <b>2.3.</b>
                    
                    Kubernetes Pod Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../network-separation-and-hardening.html">
            
                <a href="../network-separation-and-hardening.html">
            
                    
                        <b>2.4.</b>
                    
                    Network isolation and hardening
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../authentication-and-authorization.html">
            
                <a href="../authentication-and-authorization.html">
            
                    
                        <b>2.5.</b>
                    
                    Authentication and Authorization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../logging.html">
            
                <a href="../logging.html">
            
                    
                        <b>2.6.</b>
                    
                    Log Audit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../upgrading-and-application-security-practices.html">
            
                <a href="../upgrading-and-application-security-practices.html">
            
                    
                        <b>2.7.</b>
                    
                    Upgrading and application security practices
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Appendix</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="a.html">
            
                <a href="a.html">
            
                    
                        <b>3.1.</b>
                    
                    Appendix A: Example Dockerfile for non-root applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="b.html">
            
                <a href="b.html">
            
                    
                        <b>3.2.</b>
                    
                    Appendix B: Deployment template example for read-only file system
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="c.html">
            
                <a href="c.html">
            
                    
                        <b>3.3.</b>
                    
                    Appendix C: Pod Security Policy Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="d.html">
            
                <a href="d.html">
            
                    
                        <b>3.4.</b>
                    
                    Appendix D: Namespace Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="e.html">
            
                <a href="e.html">
            
                    
                        <b>3.5.</b>
                    
                    Appendix E: Network Policy Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="f.html">
            
                <a href="f.html">
            
                    
                        <b>3.6.</b>
                    
                    Appendix F: LimitRange Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="g.html">
            
                <a href="g.html">
            
                    
                        <b>3.7.</b>
                    
                    Appendix G: ResourceQuota Example
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.8" data-path="h.html">
            
                <a href="h.html">
            
                    
                        <b>3.8.</b>
                    
                    Appendix H: Encryption Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="i.html">
            
                <a href="i.html">
            
                    
                        <b>3.9.</b>
                    
                    Appendix I: KMS configuration example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="j.html">
            
                <a href="j.html">
            
                    
                        <b>3.10.</b>
                    
                    Appendix J: pod-reader RBAC role
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.11" data-path="k.html">
            
                <a href="k.html">
            
                    
                        <b>3.11.</b>
                    
                    Appendix K: RBAC RoleBinding and ClusterRoleBinding examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.12" data-path="l.html">
            
                <a href="l.html">
            
                    
                        <b>3.12.</b>
                    
                    Appendix L: Audit Strategy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.13" data-path="m.html">
            
                <a href="m.html">
            
                    
                        <b>3.13.</b>
                    
                    Appendix M: Example of flags for submitting audit policy files to kube-apiserver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.14" data-path="n.html">
            
                <a href="n.html">
            
                    
                        <b>3.14.</b>
                    
                    Appendix N: webhook configuration
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Appendix H: Encryption Example</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="appendix-h-encryption-example">Appendix H: Encryption Example</h1>
<p>To encrypt secret data at rest, the encryption configuration file below provides an example to specify the required encryption type and encryption key. Storing the encryption key in an encrypted file only slightly improves security. The Secret will be encrypted, but the key will be accessed in the <code>EncryptionConfiguration</code> file. This example is based on <a href="https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/" target="_blank">Kubernetes official documentation</a>.</p>
<pre class="language-"><code class="lang-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apiserver.config.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> EncryptionConfiguration
<span class="token key atrule">resources</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">resources</span><span class="token punctuation">:</span>
   <span class="token punctuation">-</span> secrets
   <span class="token key atrule">providers</span><span class="token punctuation">:</span>
   <span class="token punctuation">-</span> <span class="token key atrule">aescbc</span><span class="token punctuation">:</span>
     <span class="token key atrule">keys</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> key1
       <span class="token key atrule">secret</span><span class="token punctuation">:</span> &lt;base 64 encoded secret<span class="token punctuation">&gt;</span>
   <span class="token punctuation">-</span> <span class="token key atrule">identity</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre>
<p>To use this encryption file for encryption at rest, set the <code>--encryption-provider-config</code> flag when restarting the API server and indicate the location of the configuration file. </p>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; 2023 - 2024 | <a href="https://seifrajhi.github.io/" target="_blank"> Saif(eddine) Rajhi </a> all right reserved.</span><span class="footer-modification"> Updated at 
2024-02-23 11:20:28
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="g.html" class="navigation navigation-prev " aria-label="Previous page: Appendix G: ResourceQuota Example">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="i.html" class="navigation navigation-next " aria-label="Next page: Appendix I: KMS configuration example">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Appendix H: Encryption Example","level":"3.8","depth":1,"next":{"title":"Appendix I: KMS configuration example","level":"3.9","depth":1,"path":"appendix/i.md","ref":"appendix/i.md","articles":[]},"previous":{"title":"Appendix G: ResourceQuota Example","level":"3.7","depth":1,"path":"appendix/g.md","ref":"appendix/g.md","articles":[]},"dir":"ltr"},"config":{"plugins":["github","codesnippet","splitter","page-toc-button","image-captions","editlink","back-to-top-button","-lunr","-search","search-plus","github-buttons@2.1.0","favicon@^0.0.2","tbfed-pagefooter@^0.0.1","theme-default","-highlight","prism","prism-themes","lightbox","sitemap-general","insert-logo","hide-element","adsense"],"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright Â© 2023 - 2024 | <a href =https://seifrajhi.github.io/> Saif(eddine) Rajhi </a>","modify_label":" Updated at ","modify_format":"YYYY-MM-DD HH:mm:ss"},"prism":{"css":["prism-themes/themes/prism-ghcolors.css"]},"github":{"url":"https://github.com/seifrajhi/kubernetes-hardening-checklist-guidance"},"editlink":{"label":"Edit this page","multilingual":false,"base":"https://github.com/seifrajhi/kubernetes-hardening-checklist-guidance/blob/main/"},"splitter":{},"adsense":{"client":"ca-pub-4029167986768912","slot":"2445941692","format":"auto","element":".page-inner section","position":"bottom"},"codesnippet":{},"sitemap-general":{"prefix":"https://seifrajhi.github.io/kubernetes-hardening-checklist-guidance/"},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"favicon":{"shortcut":"favicon.ico","bookmark":"favicon.ico"},"lightbox":{"jquery":true,"sameUuid":false},"page-toc-button":{},"back-to-top-button":{},"prism-themes":{},"github-buttons":{"repo":"seifrajhi/kubernetes-hardening-checklist-guidance","types":["star"],"size":"small"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"showLevel":true,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"insert-logo":{"style":"background: none; max-height: 100px; min-height: 30px","url":"https://seifrajhi.github.io/images/favicon.ico"},"search-plus":{},"image-captions":{"caption":"_CAPTION_","variable_name":"_pictures"}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"_pictures":[{"backlink":"introduction.html#fig2.1.1","level":"2.1","list_caption":"Figure: Figure 1: High-level view of Kubernetes cluster components","alt":"Figure 1: High-level view of Kubernetes cluster components","nro":1,"url":"images/f1.jpg","index":1,"caption_template":"_CAPTION_","label":"Figure 1: High-level view of Kubernetes cluster components","attributes":{},"skip":false,"key":"2.1.1"},{"backlink":"introduction.html#fig2.1.2","level":"2.1","list_caption":"Figure: Figure 2: Kubernetes architecture","alt":"Figure 2: Kubernetes architecture","nro":2,"url":"images/f2.jpg","index":2,"caption_template":"_CAPTION_","label":"Figure 2: Kubernetes architecture","attributes":{},"skip":false,"key":"2.1.2"},{"backlink":"kubernetes-pod-security.html#fig2.3.1","level":"2.3","list_caption":"Figure: Figure 3: Pod component with sidecar proxy as log container","alt":"Figure 3: Pod component with sidecar proxy as log container","nro":3,"url":"images/f3.jpg","index":1,"caption_template":"_CAPTION_","label":"Figure 3: Pod component with sidecar proxy as log container","attributes":{},"skip":false,"key":"2.3.1"},{"backlink":"kubernetes-pod-security.html#fig2.3.2","level":"2.3","list_caption":"Figure: Figure 4: Container build workflow, optimized with webhook and admission controller","alt":"Figure 4: Container build workflow, optimized with webhook and admission controller","nro":4,"url":"images/f4.jpg","index":2,"caption_template":"_CAPTION_","label":"Figure 4: Container build workflow, optimized with webhook and admission controller","attributes":{},"skip":false,"key":"2.3.2"},{"backlink":"logging.html#fig2.6.1","level":"2.6","list_caption":"Figure: Figure 5: Cluster leverages service mesh to combine logs with network security","alt":"Figure 5: Cluster leverages service mesh to combine logs with network security","nro":5,"url":"images/f5.jpg","index":1,"caption_template":"_CAPTION_","label":"Figure 5: Cluster leverages service mesh to combine logs with network security","attributes":{},"skip":false,"key":"2.6.1"}]},"title":"Kubernetes Hardening Guide (Produced by the National Security Agency)","links":{"sidebar":{"Return to home page":"https://seifrajhi.github.io/kubernetes-hardening-checklist-guidance"}},"gitbook":"*","description":""},"file":{"path":"appendix/h.md","mtime":"2024-02-23T11:20:28.971Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-02-23T11:20:57.217Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-editlink/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lightbox/js/lightbox.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-insert-logo/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-adsense/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

